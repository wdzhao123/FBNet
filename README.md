# FBNet
Dataset and code for the paper of "Feature Balance for Fine-Grained Object
Classification in Aerial Images"
# Requirement
python == 3.6

pytorch == 1.4.0
# Datasets
Datasets: LFS, DOTA, FS23, HRSC2016

链接：https://pan.baidu.com/s/1xiLdHd5L32a_ljqc2ZRyLg 提取码：85jz
# Parameters
Network parameters that are trained on four datasets

链接：https://pan.baidu.com/s/1litPjPPRDY2nP5LC4Gta-Q 提取码：saip
# Train
Training the entire network can be divided into three steps：

Configure the relevant parameters before running the code.

1.Train a super-resolution network

  run SISR.py
  
2.Use the super-resolution network trained in step 1 to help the classification network.
  
  run SISR_help_res.py
 
3.Use the gradcam generated by the classification network in step 2 to retrain super-resolution network.

  run SISR_with_gradcam.py

# Test
If you test our network on dataset LFS, please use code for LFS

If you test our network on dataset DOTA,FS23,HRSC2016, please use code for FS23,HRSC2016,DOTA

Note that code for LFS uses the single channel as the input and code for FS23,HRSC2016,DOTA uses the three channel as the input

run test.py to test category accuracy or single image

# Cite

If our paper can bring you some help, please cite it: 

```
@ARTICLE{9739789,
  author={Zhao, Wenda and Tong, Tingting and Yao, Libo and Liu, Yu and Xu, Congan and He, You and Lu, Huchuan},
  journal={IEEE Transactions on Geoscience and Remote Sensing}, 
  title={Feature Balance for Fine-Grained Object Classification in Aerial Images}, 
  year={2022},
  volume={},
  number={},
  pages={1-1},
  doi={10.1109/TGRS.2022.3161433}}
```



